import{d as le,h as ne,a as R,f as M,s as L}from"../chunks/BcWSPPfT.js";import{h as w,A as V,B as ie,C as oe,D as fe,b as de,i as g,F as ue,H as ve,G as J,I as Y,c as $,J as ce,K as Z,a as z,L as he,M as _e,N as be,O as j,P as q,Q as P,R as ge,S as X,T as pe,U as G,V as ye,W as me,X as xe,d as Ee,Y as Ae,Z as we,_ as Ce,p as De,j as B,a0 as Te,o as Ie,g as O,k as Ne,e as ke,$ as Re,s as N,f as C,r as A,t as K,a1 as Me}from"../chunks/vJz4ddcz.js";import{i as Q}from"../chunks/Dt66tBJQ.js";import{r as Se,A as ee,C as $e}from"../chunks/9G70Bn6P.js";function He(t,e,r,a){for(var u=[],v=e.length,o=0;o<v;o++)ye(e[o].e,u,!0);var c=v>0&&u.length===0&&r!==null;if(c){var p=r.parentNode;me(p),p.append(r),a.clear(),D(t,e[0].prev,e[v-1].next)}xe(u,()=>{for(var _=0;_<v;_++){var s=e[_];c||(a.delete(s.k),D(t,s.prev,s.next)),Ee(s.e,!c)}})}function Le(t,e,r,a,u,v=null){var o=t,c={flags:e,items:new Map,first:null};{var p=t;o=w?V(ie(p)):p.appendChild(oe())}w&&fe();var _=null,s=!1,n=_e(()=>{var l=r();return be(l)?l:l==null?[]:j(l)});de(()=>{var l=g(n),f=l.length;if(s&&f===0)return;s=f===0;let d=!1;if(w){var m=ue(o)===ve;m!==(f===0)&&(o=J(),V(o),Y(!1),d=!0)}if(w){for(var b=null,i,h=0;h<f;h++){if($.nodeType===8&&$.data===ce){o=$,d=!0,Y(!1);break}var x=l[h],y=a(x,h);i=re($,c,b,null,x,y,h,u,e,r),c.items.set(y,i),b=i}f>0&&V(J())}w||Be(l,c,o,u,e,a,r),v!==null&&(f===0?_?Z(_):_=z(()=>v(o)):_!==null&&he(_,()=>{_=null})),d&&Y(!0),g(n)}),w&&(o=$)}function Be(t,e,r,a,u,v,o){var c=t.length,p=e.items,_=e.first,s=_,n,l=null,f=[],d=[],m,b,i,h;for(h=0;h<c;h+=1){if(m=t[h],b=v(m,h),i=p.get(b),i===void 0){var x=s?s.e.nodes_start:r;l=re(x,e,l,l===null?e.first:l.next,m,b,h,a,u,o),p.set(b,l),f=[],d=[],s=l.next;continue}if(Oe(i,m,h),(i.e.f&q)!==0&&Z(i.e),i!==s){if(n!==void 0&&n.has(i)){if(f.length<d.length){var y=d[0],E;l=y.prev;var T=f[0],k=f[f.length-1];for(E=0;E<f.length;E+=1)W(f[E],y,r);for(E=0;E<d.length;E+=1)n.delete(d[E]);D(e,T.prev,k.next),D(e,l,T),D(e,k,y),s=y,l=k,h-=1,f=[],d=[]}else n.delete(i),W(i,s,r),D(e,i.prev,i.next),D(e,i,l===null?e.first:l.next),D(e,l,i),l=i;continue}for(f=[],d=[];s!==null&&s.k!==b;)(s.e.f&q)===0&&(n??=new Set).add(s),d.push(s),s=s.next;if(s===null)continue;i=s}f.push(i),l=i,s=i.next}if(s!==null||n!==void 0){for(var I=n===void 0?[]:j(n);s!==null;)(s.e.f&q)===0&&I.push(s),s=s.next;var U=I.length;if(U>0){var S=c===0?r:null;He(e,I,S,p)}}P.first=e.first&&e.first.e,P.last=l&&l.e}function Oe(t,e,r,a){G(t.v,e),G(t.i,r)}function re(t,e,r,a,u,v,o,c,p,_){var s=(p&Ae)!==0,n=(p&we)===0,l=s?n?ge(u,!1,!1):X(u):u,f=(p&pe)===0?o:X(o),d={i:f,v:l,k:v,a:null,e:null,prev:r,next:a};try{return d.e=z(()=>c(t,l,f,_),w),d.e.prev=r&&r.e,d.e.next=a&&a.e,r===null?e.first=d:(r.next=d,r.e.next=d.e),a!==null&&(a.prev=d,a.e.prev=d.e),d}finally{}}function W(t,e,r){for(var a=t.next?t.next.e.nodes_start:r,u=e?e.e.nodes_start:r,v=t.e.nodes_start;v!==a;){var o=Ce(v);u.before(v),v=o}}function D(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function te(t){var e,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(e=0;e<u;e++)t[e]&&(r=te(t[e]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Ue(){for(var t,e,r=0,a="",u=arguments.length;r<u;r++)(t=arguments[r])&&(e=te(t))&&(a&&(a+=" "),a+=e);return a}function Ve(t){return typeof t=="object"?Ue(t):t??""}function Ye(t,e,r){var a=t==null?"":""+t;return a===""?null:a}function qe(t,e,r,a,u,v){var o=t.__className;if(w||o!==r||o===void 0){var c=Ye(r);(!w||c!==t.getAttribute("class"))&&(c==null?t.removeAttribute("class"):t.className=c),t.__className=r}return v}function Fe(){return Se($e,`${ee}/clients`)}async function Je(t){const e=await fetch(`${ee}/clients/${t}`,{method:"DELETE",credentials:"include"});if(!e.ok)throw new Error(`Delete failed (${e.status})`)}var Pe=M('<div class="text-gray-600">Loading clients...</div>'),Xe=M('<div class="text-red-600 bg-red-50 border border-red-200 rounded p-4"> </div>'),Ge=(t,e,r)=>e(g(r)),Ke=M('<tr><td class="border-b border-gray-200 px-6 py-3 text-gray-900"> </td><td class="border-b border-gray-200 px-6 py-3 text-gray-700"> </td><td class="border-b border-gray-200 px-6 py-3 text-right"><button class="text-red-600 hover:text-red-700 font-medium disabled:opacity-60" title="Delete"> </button></td></tr>'),Qe=M('<tr><td colspan="3" class="px-6 py-6 text-gray-600">No clients yet.</td></tr>'),We=M('<div class="overflow-x-auto rounded-lg border border-gray-300 bg-white shadow-sm"><table class="min-w-full border-collapse text-sm"><thead class="bg-gray-100 text-left font-semibold text-gray-800"><tr><th class="border-b border-gray-300 px-6 py-3">Name</th><th class="border-b border-gray-300 px-6 py-3">Email</th><th class="border-b border-gray-300 px-6 py-3 text-right">Actions</th></tr></thead><tbody></tbody></table></div>'),Ze=M('<h1 class="text-2xl font-bold mb-6">Clients</h1> <!>',1);function tr(t,e){De(e,!0);let r=B(Te([])),a=B(!0),u=B(null),v=B(null);Ie(async()=>{try{N(r,await Fe(),!0)}catch(n){N(u,n instanceof Error?n.message:"Failed to load clients",!0)}finally{N(a,!1)}});async function o(n){if(!confirm(`Delete client "${n.name}"?`))return;const l=g(r);N(v,n.id,!0),N(r,g(r).filter(f=>f.id!==n.id),!0);try{await Je(n.id)}catch{N(r,l,!0)}finally{N(v,null)}}var c=Ze();ne(n=>{Re.title="Clients - Svelte CRUD"});var p=O(Ne(c),2);{var _=n=>{var l=Pe();R(n,l)},s=(n,l)=>{{var f=m=>{var b=Xe(),i=C(b);A(b),K(()=>L(i,`Error: ${g(u)??""}`)),R(m,b)},d=m=>{var b=We(),i=C(b),h=O(C(i));Le(h,23,()=>g(r),x=>x.id,(x,y,E)=>{var T=Ke();const k=Me(()=>g(v)===g(y).id);var I=C(T),U=C(I,!0);A(I);var S=O(I),ae=C(S,!0);A(S);var F=O(S),H=C(F);H.__click=[Ge,o,y];var se=C(H,!0);A(H),A(F),A(T),K(()=>{qe(T,1,Ve(g(E)%2===0?"bg-white":"bg-gray-50 hover:bg-gray-100")),L(U,g(y).name),L(ae,g(y).email),H.disabled=g(k),L(se,g(k)?"Deleting...":"Delete")}),R(x,T)},x=>{var y=Qe();R(x,y)}),A(h),A(i),A(b),R(m,b)};Q(n,m=>{g(u)?m(f):m(d,!1)},l)}};Q(p,n=>{g(a)?n(_):n(s,!1)})}R(t,c),ke()}le(["click"]);export{tr as component};
